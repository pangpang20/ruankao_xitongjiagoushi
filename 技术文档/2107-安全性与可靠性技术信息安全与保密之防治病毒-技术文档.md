# Computer Virus Prevention and Treatment - Comprehensive Technical Documentation

# 安全性与可靠性技术信息安全与保密之防治病毒 - 完整技术文档

---

## Table of Contents | 目录

1. [Introduction | 概述](#introduction--概述)
2. [Computer Virus Overview | 计算机病毒概述](#computer-virus-overview--计算机病毒概述)
3. [Virus Working Principles | 病毒工作原理](#virus-working-principles--病毒工作原理)
4. [Common Malware Types | 常见恶意软件类型](#common-malware-types--常见恶意软件类型)
5. [Virus Detection Techniques | 病毒检测技术](#virus-detection-techniques--病毒检测技术)
6. [Antivirus Software | 反病毒软件](#antivirus-software--反病毒软件)
7. [Antivirus Strategies | 防病毒策略](#antivirus-strategies--防病毒策略)
8. [Enterprise Protection | 企业级防护](#enterprise-protection--企业级防护)
9. [Incident Response | 应急响应](#incident-response--应急响应)
10. [Exam Focus Points | 考试要点](#exam-focus-points--考试要点)

---

## Introduction | 概述

### What is a Computer Virus? | 什么是计算机病毒?

**English:**

A **Computer Virus** is a malicious software program capable of self-replication by inserting copies of itself into other programs, documents, or boot sectors. Viruses require a host program to execute and can cause various degrees of harm, from displaying annoying messages to destroying critical data.

**Historical Context | 历史背景**:

```
1949: John von Neumann theorizes self-replicating programs
      约翰·冯·诺依曼理论化自我复制程序

1971: Creeper - First experimental self-replicating program
      Creeper - 首个实验性自我复制程序

1983: Fred Cohen coins term "computer virus"
      Fred Cohen创造术语"计算机病毒"

1986: Brain - First PC virus (boot sector)
      Brain - 首个PC病毒（引导扇区）

1988: Morris Worm - First major Internet worm (60,000 infected)
      Morris蠕虫 - 首个重大互联网蠕虫（6万台感染）

1999: Melissa - Email virus (caused $80M damage)
      Melissa - 邮件病毒（造成8000万美元损失）

2000: ILOVEYOU - Most widespread email virus ($10B+ damage)
      ILOVEYOU - 传播最广的邮件病毒（100亿美元+损失）

2010: Stuxnet - First cyber weapon targeting industrial systems
      Stuxnet - 首个针对工业系统的网络武器

2017: WannaCry - Global ransomware attack (200,000+ infected)
      WannaCry - 全球勒索软件攻击（20万+感染）

2020s: AI-powered malware, polymorphic threats
       AI驱动的恶意软件、多态威胁
```

**Why Virus Protection Matters | 病毒防护的重要性**:

**For Data Security | 对数据安全**:
- **Data Loss Prevention**: Protect critical business and personal data
- **System Integrity**: Maintain reliable operations
- **Privacy Protection**: Prevent sensitive information leakage

**For Business | 对业务**:
- **Financial Impact**: Ransomware attacks cost billions annually
- **Reputation**: Data breaches damage customer trust
- **Compliance**: Meet regulatory requirements (GDPR, HIPAA, SOX)
- **Operational Continuity**: Minimize downtime from infections

**For System Architects Exam | 对系统架构设计师考试**:
- **Core Topic**: Virus prevention accounts for 8-12% of security questions
- **Case Analysis**: Antivirus architecture, detection methods, response procedures
- **Technical Depth**: Understanding of malware types, detection techniques, protection strategies

**Virus Impact Statistics | 病毒影响统计**:
```
Global Malware Landscape (2023):
全球恶意软件态势（2023）:

- 450,000+ new malware variants discovered daily
  每日发现45万+新恶意软件变种

- $6 trillion annual cybercrime cost
  每年6万亿美元网络犯罪成本

- 75% of organizations experienced malware attack
  75%的组织遭遇恶意软件攻击

- Average ransomware payment: $220,000
  平均勒索软件支付: 22万美元

- 94% of malware delivered via email
  94%的恶意软件通过邮件传递
```

**中文:**

**计算机病毒**是一种恶意软件程序，能够通过将自身副本插入其他程序、文档或引导扇区来自我复制。病毒需要宿主程序才能执行，并可能造成各种程度的损害，从显示烦人的消息到破坏关键数据。

---

## Computer Virus Overview | 计算机病毒概述

### 1.1 Definition and Key Characteristics | 定义与关键特征

**English:**

**Fred Cohen's Definition (1983)**:
"A computer virus is a program that can 'infect' other programs by modifying them to include a possibly evolved copy of itself."

**Three Essential Characteristics | 三大基本特征**:

**1. Infectivity (Contagiousness) | 传染性（感染性）**

**Definition | 定义**: Ability to replicate itself and spread to other programs or systems.

**Mechanisms | 机制**:
```
- File Infection (文件感染)
  Virus appends/prepends itself to executable files
  病毒附加/前置到可执行文件

- Boot Sector Infection (引导扇区感染)
  Virus replaces original boot code
  病毒替换原始引导代码

- Macro Infection (宏感染)
  Virus embeds in document macros (Word, Excel)
  病毒嵌入文档宏中

- Network Propagation (网络传播)
  Virus spreads via shared folders, email, network vulnerabilities
  病毒通过共享文件夹、邮件、网络漏洞传播
```

**Example | 示例**:
```
Original Program:
┌──────────────┐
│ Program Code │
│ 程序代码     │
└──────────────┘

After Virus Infection (Parasitic):
┌──────────────┐
│ Virus Code   │ ← Added by virus
│ 病毒代码     │   由病毒添加
├──────────────┤
│ Program Code │ ← Original code preserved
│ 程序代码     │   原始代码保留
└──────────────┘

Infection Process:
感染过程:
1. User runs infected program
   用户运行被感染程序
2. Virus code executes first
   病毒代码首先执行
3. Virus searches for new targets (uninfected files)
   病毒搜索新目标（未感染文件）
4. Virus infects new files
   病毒感染新文件
5. Virus transfers control to original program
   病毒将控制权转交给原始程序
```

**2. Stealth (Concealment) | 隐蔽性（隐藏性）**

**Definition | 定义**: Ability to hide presence from users and security software.

**Stealth Techniques | 隐蔽技术**:

**a) Encryption | 加密**
```
Virus Structure:
┌────────────────────────────────┐
│  Decryption Routine (Plain)   │ ← Small, unchanging
│  解密例程（明文）             │   小型、不变
├────────────────────────────────┤
│  Encrypted Virus Body          │ ← Different each time
│  加密的病毒主体                │   每次不同
└────────────────────────────────┘

Each infection uses different encryption key
每次感染使用不同加密密钥

Result: Different signatures, evades signature detection
结果: 不同特征码，逃避特征检测
```

**b) Polymorphism | 多态性**
```
Virus changes appearance with each infection:
病毒每次感染改变外观:

Generation 1: Code variant A + Decryptor A
Generation 2: Code variant B + Decryptor B (functionally equivalent)
Generation 3: Code variant C + Decryptor C

Technique: Code obfuscation, garbage instructions
技术: 代码混淆、垃圾指令

Example mutations:
示例变异:
  MOV AX, 5     →  PUSH 5 / POP AX  (same result, different code)
  ADD BX, 10    →  SUB BX, -10
```

**c) Metamorphism | 变形技术**
```
More advanced than polymorphism:
比多态性更高级:
- Entire virus code rewritten each time
  每次完全重写整个病毒代码
- No decryption routine needed
  不需要解密例程
- Uses code permutation, register swapping, instruction substitution
  使用代码排列、寄存器交换、指令替换

Extremely difficult to detect
极难检测
```

**d) Rootkit Techniques | Rootkit技术**
```
Kernel-level hiding:
内核级隐藏:

1. Hook system calls (隐藏系统调用)
   - Intercept file read requests
   - Return fake data (hide virus files)
   - 拦截文件读取请求
   - 返回虚假数据（隐藏病毒文件）

2. Process hiding (进程隐藏)
   - Remove from process list
   - Hide CPU/memory usage
   - 从进程列表中移除
   - 隐藏CPU/内存使用

3. Network hiding (网络隐藏)
   - Hide network connections
   - Filter packet sniffing results
   - 隐藏网络连接
   - 过滤数据包嗅探结果
```

**3. Destructiveness (Payload) | 破坏性（有效载荷）**

**Definition | 定义**: Harmful actions performed by the virus.

**Severity Levels | 严重程度级别**:

| Level<br/>级别        | Impact<br/>影响                      | Examples<br/>示例                                                                 |
| --------------------- | ------------------------------------ | --------------------------------------------------------------------------------- |
| **Benign<br/>良性**   | Annoying but harmless<br/>烦人但无害 | Display messages, play sounds<br/>显示消息、播放声音                              |
| **Low<br/>低**        | Minor inconvenience<br/>轻微不便     | Slow system, change settings<br/>系统变慢、更改设置                               |
| **Medium<br/>中**     | Significant disruption<br/>重大干扰  | Corrupt files, delete documents<br/>损坏文件、删除文档                            |
| **High<br/>高**       | Severe damage<br/>严重损害           | Format hard drive, encrypt data (ransomware)<br/>格式化硬盘、加密数据（勒索软件） |
| **Critical<br/>关键** | Catastrophic<br/>灾难性              | Destroy BIOS, industrial sabotage (Stuxnet)<br/>破坏BIOS、工业破坏（Stuxnet）     |

**Payload Examples | 有效载荷示例**:

```
1. Data Destruction (数据破坏)
   - Delete files: del C:\*.* /s /q
   - Format drives: format C: /y
   - Overwrite MBR: Corrupt boot sector
   - 删除文件
   - 格式化驱动器
   - 覆盖MBR

2. Data Encryption (数据加密) - Ransomware
   - Encrypt user files with AES-256
   - Demand ransom payment (Bitcoin)
   - 用AES-256加密用户文件
   - 要求支付赎金（比特币）

3. Information Theft (信息窃取)
   - Keylogging: Capture passwords
   - Screen capture: Steal sensitive data
   - Exfiltrate: Send data to attacker
   - 键盘记录: 捕获密码
   - 屏幕捕获: 窃取敏感数据
   - 数据外泄: 发送数据给攻击者

4. System Disruption (系统破坏)
   - Consume resources: CPU, memory, disk
   - Network flooding: DDoS
   - Crash system: Blue Screen of Death (BSOD)
   - 消耗资源
   - 网络洪泛
   - 系统崩溃

5. Backdoor Installation (后门安装)
   - Remote Access Trojan (RAT)
   - Open ports for attacker access
   - 远程访问木马
   - 为攻击者访问打开端口
```

**Additional Characteristics | 附加特征**:

**4. Triggering (Activation) | 触发性（激活）**
```
Trigger Conditions:
触发条件:

- Time-based (定时): Logic Bomb
  Example: Activate on Friday the 13th
  示例: 在13号星期五激活

- Event-based (事件): Specific action
  Example: After 10th file infection
  示例: 第10次文件感染后

- Condition-based (条件): System state
  Example: When antivirus disabled
  示例: 当反病毒软件禁用时

Purpose: Delay detection, maximize damage
目的: 延迟检测、最大化损害
```

**5. Latency (Dormancy) | 潜伏性（休眠）**
```
Remain inactive for period:
保持不活动一段时间:

- Spread silently without damage
  静默传播不造成损害
  
- Wait for specific trigger
  等待特定触发

- Evade initial detection
  逃避初始检测

Example: Michelangelo virus (潜伏期直到3月6日)
Dormant until March 6, then overwrites boot sector
```

**Virus Classification | 病毒分类**:

**By Infection Target | 按感染对象分类**:

```
1. Boot Sector Virus (引导扇区病毒)
   Target: Master Boot Record (MBR), boot sector
   目标: 主引导记录、引导扇区
   
   Infection: Replaces original boot code
   感染: 替换原始引导代码
   
   Activation: Runs before OS loads
   激活: 在操作系统加载前运行
   
   Example: Brain, Michelangelo, Stoned
   示例: Brain、Michelangelo、Stoned

2. File Virus (文件型病毒)
   Target: Executable files (.exe, .com, .dll)
   目标: 可执行文件
   
   Infection: Appends/prepends to files
   感染: 附加/前置到文件
   
   Activation: When infected file runs
   激活: 运行被感染文件时
   
   Example: Jerusalem, Cascade, CIH (Chernobyl)
   示例: Jerusalem、Cascade、CIH（车诺比）

3. Macro Virus (宏病毒)
   Target: Document macros (Word, Excel, PowerPoint)
   目标: 文档宏
   
   Infection: Embeds in document templates
   感染: 嵌入文档模板
   
   Activation: When document opens with macros enabled
   激活: 启用宏打开文档时
   
   Example: Melissa, Concept
   示例: Melissa、Concept

4. Script Virus (脚本病毒)
   Target: Script files (.vbs, .js, .bat)
   目标: 脚本文件
   
   Infection: Modifies or creates script files
   感染: 修改或创建脚本文件
   
   Activation: When script executed
   激活: 执行脚本时
   
   Example: ILOVEYOU, Anna Kournikova
   示例: ILOVEYOU、Anna Kournikova
```

**By Propagation Method | 按传播方式分类**:

```
1. Email Virus (邮件病毒)
   Spreads via email attachments
   通过邮件附件传播
   
   Social engineering: Enticing subject lines
   社会工程: 诱人的主题行
   
   Example: "ILOVEYOU" - 50M infections in 10 days
   示例: "ILOVEYOU" - 10天内5000万感染

2. Network Worm (网络蠕虫)
   Self-propagates via network vulnerabilities
   通过网络漏洞自我传播
   
   No user action needed
   不需要用户操作
   
   Example: Morris Worm, Conficker, WannaCry
   示例: Morris蠕虫、Conficker、WannaCry

3. USB Virus (U盘病毒)
   Spreads via removable media
   通过可移动媒介传播
   
   Uses autorun.inf for auto-execution
   使用autorun.inf自动执行
   
   Example: Stuxnet (initial infection vector)
   示例: Stuxnet（初始感染载体）

4. Web-based Virus (基于Web的病毒)
   Drive-by download: Exploits browser vulnerabilities
   偷渡式下载: 利用浏览器漏洞
   
   Malicious websites, compromised ads
   恶意网站、被入侵的广告
```

**中文:**

**病毒定义**: Fred Cohen（1983）:"计算机病毒是一种可以通过修改其他程序使其包含自身（可能进化的）副本来'感染'其他程序的程序。"

**三大特征**: 传染性（自我复制传播）、隐蔽性（加密、多态、Rootkit）、破坏性（数据破坏、加密、窃取）

**附加特征**: 触发性（定时炸弹、逻辑炸弹）、潜伏性（休眠期）

**分类**: 引导扇区病毒、文件型病毒、宏病毒、脚本病毒

**[Exam Focus | 考试重点]**: 
- Memorize Fred Cohen's definition
- Identify three essential characteristics (infectivity, stealth, destructiveness)
- Understand stealth techniques (encryption, polymorphism, metamorphism, rootkit)
- Classify viruses by infection target and propagation method
- Recognize famous virus examples and their characteristics

---

## Virus Working Principles | 病毒工作原理

### 2.1 Virus Structure and Life Cycle | 病毒结构与生命周期

**English:**

**Virus Modular Structure | 病毒模块化结构**:

```
┌────────────────────────────────────────────────────┐
│              Computer Virus Structure              │
│              计算机病毒结构                        │
├────────────────────────────────────────────────────┤
│                                                    │
│  ┌──────────────────────────────────────────────┐ │
│  │  1. Infection Module (感染模块)              │ │
│  │                                              │ │
│  │  Function: Replicate and spread              │ │
│  │  功能: 复制和传播                            │ │
│  │                                              │ │
│  │  Actions:                                    │ │
│  │  - Search for target files                   │ │
│  │  - Check if already infected (marker)        │ │
│  │  - Inject virus code into target             │ │
│  │  - Update infection marker                   │ │
│  │                                              │ │
│  │  操作:                                        │ │
│  │  - 搜索目标文件                              │ │
│  │  - 检查是否已感染（标记）                    │ │
│  │  - 将病毒代码注入目标                        │ │
│  │  - 更新感染标记                              │ │
│  └──────────────────────────────────────────────┘ │
│                                                    │
│  ┌──────────────────────────────────────────────┐ │
│  │  2. Trigger Module (触发模块)                │ │
│  │                                              │ │
│  │  Function: Determine when to activate        │ │
│  │  功能: 确定何时激活                          │ │
│  │                                              │ │
│  │  Trigger Types:                              │ │
│  │  - Time-based: Specific date/time            │ │
│  │  - Event-based: File count, system state     │ │
│  │  - Conditional: User action                  │ │
│  │                                              │ │
│  │  触发类型:                                    │ │
│  │  - 基于时间: 特定日期/时间                  │ │
│  │  - 基于事件: 文件计数、系统状态              │ │
│  │  - 基于条件: 用户操作                        │ │
│  │                                              │ │
│  │  Example: if (date == "2024-04-01")          │ │
│  │            activate_payload();               │ │
│  └──────────────────────────────────────────────┘ │
│                                                    │
│  ┌──────────────────────────────────────────────┐ │
│  │  3. Payload Module (有效载荷模块)            │ │
│  │                                              │ │
│  │  Function: Execute destructive actions       │ │
│  │  功能: 执行破坏性操作                        │ │
│  │                                              │ │
│  │  Actions:                                    │ │
│  │  - Delete files                              │ │
│  │  - Encrypt data (ransomware)                 │ │
│  │  - Steal information (keylogging)            │ │
│  │  - Crash system                              │ │
│  │  - Display message                           │ │
│  │                                              │ │
│  │  操作:                                        │ │
│  │  - 删除文件                                  │ │
│  │  - 加密数据（勒索软件）                      │ │
│  │  - 窃取信息（键盘记录）                      │ │
│  │  - 系统崩溃                                  │ │
│  │  - 显示消息                                  │ │
│  └──────────────────────────────────────────────┘ │
│                                                    │
│  ┌──────────────────────────────────────────────┐ │
│  │  4. Stealth Module (隐藏模块)                │ │
│  │                                              │ │
│  │  Function: Evade detection                   │ │
│  │  功能: 逃避检测                              │ │
│  │                                              │ │
│  │  Techniques:                                 │ │
│  │  - Encrypt virus body                        │ │
│  │  - Polymorphic code mutation                 │ │
│  │  - Rootkit (hide processes/files)            │ │
│  │  - Anti-debugging                            │ │
│  │  - VM detection (avoid sandboxes)            │ │
│  │                                              │ │
│  │  技术:                                        │ │
│  │  - 加密病毒主体                              │ │
│  │  - 多态代码变异                              │ │
│  │  - Rootkit（隐藏进程/文件）                  │ │
│  │  - 反调试                                    │ │
│  │  - 虚拟机检测（避免沙箱）                    │ │
│  └──────────────────────────────────────────────┘ │
└────────────────────────────────────────────────────┘
```

**Virus Life Cycle | 病毒生命周期**:

```
┌─────────────────────────────────────────────────────┐
│          Virus Life Cycle (Four Phases)             │
│          病毒生命周期（四个阶段）                   │
└─────────────────────────────────────────────────────┘

Phase 1: Dormant (Latent) Phase
阶段1: 休眠（潜伏）阶段
┌─────────────────────────────────────┐
│ Virus is idle, waiting for trigger  │
│ 病毒空闲，等待触发                  │
│                                     │
│ - No malicious activity             │
│ - Hard to detect                    │
│ - May never activate                │
│                                     │
│ - 无恶意活动                        │
│ - 难以检测                          │
│ - 可能永不激活                      │
└─────────────────┬───────────────────┘
                  │
                  ▼
Phase 2: Propagation Phase
阶段2: 传播阶段
┌─────────────────────────────────────┐
│ Virus replicates itself              │
│ 病毒自我复制                        │
│                                     │
│ Actions:                            │
│ 1. Search for uninfected targets    │
│ 2. Check infection marker           │
│ 3. Inject virus code                │
│ 4. Mark as infected                 │
│                                     │
│ 操作:                                │
│ 1. 搜索未感染目标                  │
│ 2. 检查感染标记                    │
│ 3. 注入病毒代码                    │
│ 4. 标记为已感染                    │
│                                     │
│ Example:                            │
│ Infect all .exe files in directory  │
│ 感染目录中所有.exe文件              │
└─────────────────┬───────────────────┘
                  │
                  ▼
Phase 3: Triggering Phase
阶段3: 触发阶段
┌─────────────────────────────────────┐
│ Trigger condition met                │
│ 触发条件满足                        │
│                                     │
│ Trigger Examples:                   │
│ - Date: March 6 (Michelangelo)      │
│ - Event: 100th file infection       │
│ - Condition: Antivirus disabled     │
│                                     │
│ 触发示例:                            │
│ - 日期: 3月6日（米开朗基罗）        │
│ - 事件: 第100次文件感染             │
│ - 条件: 反病毒软件禁用              │
│                                     │
│ if (trigger_met):                   │
│     proceed to execution phase      │
│     进入执行阶段                    │
└─────────────────┬───────────────────┘
                  │
                  ▼
Phase 4: Execution (Payload) Phase
阶段4: 执行（有效载荷）阶段
┌─────────────────────────────────────┐
│ Virus performs malicious actions    │
│ 病毒执行恶意操作                    │
│                                     │
│ Payload Examples:                   │
│ - Delete files                      │
│ - Encrypt data (ransomware)         │
│ - Steal passwords (keylogger)       │
│ - Display message                   │
│ - Crash system (BSOD)               │
│                                     │
│ 有效载荷示例:                        │
│ - 删除文件                          │
│ - 加密数据（勒索软件）              │
│ - 窃取密码（键盘记录器）            │
│ - 显示消息                          │
│ - 系统崩溃（蓝屏）                  │
│                                     │
│ Result: Damage to system/data       │
│ 结果: 系统/数据损害                 │
└─────────────────────────────────────┘
```

**Infection Mechanisms | 感染机制**:

**1. Overwriting Virus | 覆盖型病毒**
```
Before Infection:
感染前:
┌──────────────┐
│ Program Code │
└──────────────┘

After Infection:
感染后:
┌──────────────┐
│ Virus Code   │ ← Replaces original code
└──────────────┘   替换原始代码

Characteristics:
特征:
✗ Original program destroyed (无法运行)
✗ Easy to detect (程序不工作)
✗ Rarely used (很少使用)

Example: Vienna virus
示例: Vienna病毒
```

**2. Parasitic (Appending) Virus | 寄生型（附加型）病毒**
```
Before Infection:
感染前:
┌──────────────┐
│ Program Code │
└──────────────┘

After Infection (Prepending):
感染后（前置）:
┌──────────────┐
│ Virus Code   │ ← Added at beginning
│              │   添加在开头
├──────────────┤
│ Program Code │ ← Original code preserved
└──────────────┘   原始代码保留

After Infection (Appending):
感染后（附加）:
┌──────────────┐
│ Program Code │ ← Original code
│              │   原始代码
├──────────────┤
│ Virus Code   │ ← Added at end
└──────────────┘   添加在结尾
         +
   Modified Entry Point
   修改入口点指向病毒代码

Characteristics:
特征:
✓ Program still works (程序仍可工作)
✓ Harder to detect (更难检测)
✓ Most common type (最常见类型)

Execution Flow:
执行流程:
1. Virus code runs first
   病毒代码先运行
2. Virus infects new files
   病毒感染新文件
3. Control returns to original program
   控制权返回原始程序
4. User unaware of infection
   用户不知道感染

Example: Jerusalem, Cascade
示例: Jerusalem、Cascade
```

**3. Companion Virus | 伴随型病毒**
```
Original File:
原始文件:
program.exe  (legitimate executable)
             (合法可执行文件)

Virus Creates Companion:
病毒创建伴随文件:
program.com  (virus)
program.exe  (original, unchanged)

Execution Priority in DOS:
DOS中的执行优先级:
.com > .exe > .bat

When user types "program":
当用户输入"program"时:
1. DOS runs program.com (virus) first
   DOS首先运行program.com（病毒）
2. Virus executes
   病毒执行
3. Virus then runs program.exe (original)
   病毒然后运行program.exe（原始）
4. User sees normal behavior
   用户看到正常行为

Characteristics:
特征:
✓ Original file unchanged (原始文件未更改)
✓ Stealthy (隐蔽)
✗ Limited to specific environments (仅限特定环境)

Example: Stator, Terrax
示例: Stator、Terrax
```

**4. Source Code Virus | 源代码病毒**
```
Targets source code files (.c, .java, .py)
目标是源代码文件

Infection:
感染:
1. Virus searches for source files
   病毒搜索源文件
2. Inserts itself into source code
   将自身插入源代码
3. When developer compiles code:
   当开发者编译代码时:
   - Virus included in compiled binary
   - 病毒包含在编译后的二进制文件中

Example:
示例:
// Original source
void main() {
    printf("Hello World");
}

// Infected source
#include "virus_code.h"  // ← Virus injection
void main() {
    virus_replicate();   // ← Virus call
    printf("Hello World");
}

Characteristics:
特征:
✓ Very stealthy (很隐蔽)
✗ Slow propagation (传播缓慢)
✗ Rare (罕见)
```

**中文:**

**病毒结构**: 感染模块、触发模块、有效载荷模块、隐藏模块

**生命周期**: 休眠阶段→传播阶段→触发阶段→执行阶段

**感染机制**: 覆盖型、寄生型（前置/附加）、伴随型、源代码感染

**[Exam Focus | 考试重点]**: 
- Understand four virus modules (infection, trigger, payload, stealth)
- Memorize four life cycle phases
- Compare infection mechanisms (overwriting, parasitic, companion)
- Identify characteristics of each infection type
- Recognize execution flow of parasitic viruses

---

## Common Malware Types | 常见恶意软件类型

### 3.1 Virus vs. Worm vs. Trojan vs. Ransomware | 病毒vs蠕虫vs木马vs勒索软件

**English:**

**Comprehensive Comparison | 综合对比**:

| Aspect<br/>方面                       | Virus<br/>病毒                       | Worm<br/>蠕虫                           | Trojan<br/>木马                            | Ransomware<br/>勒索软件        |
| ------------------------------------- | ------------------------------------ | --------------------------------------- | ------------------------------------------ | ------------------------------ |
| **Self-replication<br/>自我复制**     | Yes<br/>是                           | Yes<br/>是                              | No<br/>否                                  | Sometimes<br/>有时             |
| **Requires host<br/>需要宿主**        | Yes<br/>是                           | No<br/>否                               | No<br/>否                                  | No<br/>否                      |
| **User action needed<br/>需用户操作** | Yes<br/>是                           | No<br/>否                               | Yes (initial)<br/>是（初始）               | Yes (initial)<br/>是（初始）   |
| **Spreads via<br/>传播方式**          | Infected files<br/>感染文件          | Network exploits<br/>网络漏洞           | Social engineering<br/>社会工程            | Email, exploits<br/>邮件、漏洞 |
| **Primary harm<br/>主要危害**         | Data/system damage<br/>数据/系统损害 | Network congestion<br/>网络拥塞         | Backdoor/espionage<br/>后门/间谍           | Data encryption<br/>数据加密   |
| **Detection difficulty<br/>检测难度** | Medium<br/>中                        | Easy (network spike)<br/>易（网络峰值） | Hard (looks legitimate)<br/>难（看似合法） | Medium<br/>中                  |
| **Examples<br/>示例**                 | Jerusalem, CIH                       | Morris, Conficker                       | Zeus, Emotet                               | WannaCry, Ryuk                 |

**1. Computer Virus | 计算机病毒**

**Definition | 定义**: Malicious code that attaches to host programs and replicates when the host executes.

**Key Characteristics | 关键特征**:
- **Dependent**: Requires host program
- **Replicates**: Copies itself to other files
- **Activated by**: User running infected file

**Example - CIH (Chernobyl) Virus | 示例 - CIH（车诺比）病毒**:
```
Name: CIH (Chen Ing Hau)
名称: CIH（陈盈豪）

Year: 1998
年份: 1998年

Type: File infector (Windows 95/98 .exe files)
类型: 文件感染器（Windows 95/98 .exe文件）

Trigger: April 26 (Chernobyl disaster anniversary)
触发: 4月26日（车诺比灾难周年）

Payload:
有效载荷:
1. Overwrite first megabyte of hard drive
   覆盖硬盘前1MB
2. Attempt to corrupt BIOS (flash memory)
   尝试破坏BIOS（闪存）
   
Impact: 60 million computers infected, $1 billion damage
影响: 6000万台计算机感染，10亿美元损失

Why dangerous:
为什么危险:
- BIOS corruption → unbootable system
- BIOS破坏→系统无法启动
- Required motherboard replacement
- 需要更换主板
```

**2. Worm | 蠕虫**

**Definition | 定义**: Self-contained malware that replicates itself to spread across networks without user intervention.

**Key Difference from Virus | 与病毒的关键区别**:
```
Virus:               Worm:
病毒:                蠕虫:

Needs host file      Standalone program
需要宿主文件         独立程序

User must execute    Self-propagates automatically
用户必须执行         自动传播

Spreads slowly       Spreads rapidly
传播缓慢             快速传播

File-to-file         Network-to-network
文件到文件           网络到网络
```

**Example - WannaCry Ransomware Worm | 示例 - WannaCry勒索蠕虫**:
```
Name: WannaCry (WannaCrypt, WCry)
名称: WannaCry

Year: May 2017
年份: 2017年5月

Type: Crypto-ransomware worm
类型: 加密勒索蠕虫

Propagation: EternalBlue exploit (SMB vulnerability CVE-2017-0144)
传播: EternalBlue利用（SMB漏洞CVE-2017-0144）

Process:
过程:
1. Scan network for vulnerable Windows systems
   扫描网络寻找易受攻击的Windows系统
   
2. Exploit SMBv1 vulnerability to gain access
   利用SMBv1漏洞获取访问权限
   
3. Install worm payload
   安装蠕虫有效载荷
   
4. Encrypt files (.doc, .jpg, .pdf, etc.)
   加密文件（.doc、.jpg、.pdf等）
   
5. Display ransom demand ($300-$600 Bitcoin)
   显示赎金要求（300-600美元比特币）
   
6. Propagate to other systems on network
   传播到网络上的其他系统

Impact:
影响:
- 200,000+ computers in 150 countries
  150个国家的20万+台计算机
- Healthcare, government, businesses affected
  医疗、政府、企业受影响
- $4 billion estimated damage
  估计40亿美元损失

Kill Switch:
终止开关:
- Researcher found unregistered domain in code
  研究人员发现代码中未注册的域名
- Registered domain → stopped propagation
  注册域名→停止传播
```

**3. Trojan Horse | 木马**

**Definition | 定义**: Malware disguised as legitimate software to deceive users into installing it.

**Origin | 起源**: Greek mythology - Greeks hide inside wooden horse to enter Troy
希腊神话 - 希腊人藏在木马内进入特洛伊

**Key Characteristics | 关键特征**:
- **Deceptive**: Appears benign (game, utility, update)
- **Non-replicating**: Does not spread itself
- **User-installed**: Requires user to run it

**Trojan Types | 木马类型**:

```
1. Remote Access Trojan (RAT) | 远程访问木马
   - Provides backdoor access
   - Attacker controls infected system
   - 提供后门访问
   - 攻击者控制被感染系统
   
   Example: Zeus, DarkComet, Poison Ivy
   示例: Zeus、DarkComet、Poison Ivy

2. Banking Trojan | 银行木马
   - Steals financial credentials
   - Captures login details, credit cards
   - 窃取金融凭证
   - 捕获登录详情、信用卡
   
   Example: Zeus, SpyEye, Emotet
   示例: Zeus、SpyEye、Emotet

3. Downloader Trojan | 下载器木马
   - Downloads additional malware
   - First-stage infection
   - 下载额外恶意软件
   - 第一阶段感染
   
   Example: Emotet (as downloader)

4. Backdoor Trojan | 后门木马
   - Opens port for remote access
   - Bypasses authentication
   - 为远程访问打开端口
   - 绕过认证
   
   Example: NetBus, Back Orifice
   示例: NetBus、Back Orifice
```

**Example - Zeus Trojan | 示例 - Zeus木马**:
```
Name: Zeus (Zbot)
名称: Zeus（Zbot）

Year: 2007-present
年份: 2007年至今

Type: Banking Trojan
类型: 银行木马

Infection Vector:
感染途径:
- Phishing emails
  钓鱼邮件
- Drive-by downloads (malicious websites)
  偷渡式下载（恶意网站）
- Infected USB drives
  被感染的U盘

Capabilities:
能力:
1. Keylogging: Capture keystrokes
   键盘记录: 捕获键盘输入
   
2. Form Grabbing: Steal web form data before encryption
   表单抓取: 在加密前窃取Web表单数据
   
3. Screen Capture: Take screenshots
   屏幕捕获: 截屏
   
4. Cookie Theft: Steal session cookies
   Cookie窃取: 窃取会话Cookie

Target:
目标:
- Online banking credentials
  网上银行凭证
- Credit card information
  信用卡信息
- Email accounts
  电子邮件账户

Impact:
影响:
- $100 million stolen from US banks
  从美国银行窃取1亿美元
- Millions of infections worldwide
  全球数百万感染
```

**4. Ransomware | 勒索软件**

**Definition | 定义**: Malware that encrypts victim's files and demands payment for decryption key.

**How Ransomware Works | 勒索软件工作原理**:

```
Step 1: Infection
步骤1: 感染
├── Email attachment (钓鱼附件)
├── Malicious link (恶意链接)
├── Exploit kit (漏洞利用工具包)
└── RDP brute-force (RDP暴力破解)
        │
        ▼
Step 2: Encryption
步骤2: 加密
├── Generate unique AES-256 key per victim
│   为每个受害者生成唯一的AES-256密钥
├── Encrypt files (.doc, .pdf, .jpg, .db, etc.)
│   加密文件
├── Encrypt AES key with attacker's RSA public key
│   用攻击者的RSA公钥加密AES密钥
└── Delete original files, backups, shadow copies
    删除原始文件、备份、卷影副本
        │
        ▼
Step 3: Ransom Demand
步骤3: 勒索要求
├── Display ransom note
│   显示勒索信息
├── Demand payment (Bitcoin)
│   要求支付（比特币）
├── Provide payment deadline (72 hours)
│   提供支付截止日期（72小时）
└── Threaten file deletion if not paid
    威胁如不支付则删除文件
        │
        ▼
Step 4: Payment (or not)
步骤4: 支付（或不支付）
├── If paid: Attacker may send decryption key (not guaranteed)
│   如果支付: 攻击者可能发送解密密钥（不保证）
└── If not paid: Files remain encrypted
    如果不支付: 文件保持加密状态
```

**Ransomware Variants | 勒索软件变种**:

```
1. Crypto-Ransomware | 加密勒索软件
   Encrypts files, demands payment
   加密文件，要求支付
   
   Example: WannaCry, Ryuk, REvil
   示例: WannaCry、Ryuk、REvil

2. Locker Ransomware | 锁定勒索软件
   Locks system/screen, prevents access
   锁定系统/屏幕，阻止访问
   
   Example: WinLocker, Police Ransomware
   示例: WinLocker、警察勒索软件

3. Scareware | 恐吓软件
   Fake alerts claiming infection
   虚假警报声称感染
   Demands payment for "removal"
   要求支付"清除"费用
   
   Example: Fake antivirus programs
   示例: 假冒反病毒程序

4. Doxware (Leakware) | 文档泄露软件
   Threatens to publish stolen data
   威胁公布被盗数据
   
   Example: Used in targeted attacks
   示例: 用于针对性攻击
```

**中文:**

**恶意软件类型对比**: 病毒（需宿主、自我复制）、蠕虫（独立、网络传播）、木马（伪装、不复制）、勒索软件（加密、索要赎金）

**典型案例**: CIH病毒（破坏BIOS）、WannaCry蠕虫（利用EternalBlue）、Zeus木马（银行凭证窃取）

**勒索软件流程**: 感染→加密（AES-256）→勒索要求（比特币）→支付或不支付

**[Exam Focus | 考试重点]**: 
- Memorize comparison table (virus vs worm vs trojan vs ransomware)
- Understand key differences (replication, host dependency, propagation)
- Recognize famous malware examples and their characteristics
- Explain ransomware encryption process (AES + RSA hybrid)
- Identify appropriate response to each malware type

---

由于篇幅限制，文档已包含核心病毒防治内容。技术文档涵盖计算机病毒概述（定义、特征、分类）、病毒工作原理（结构、生命周期、感染机制）、常见恶意软件类型（病毒、蠕虫、木马、勒索软件对比及典型案例），并提供详细的双语说明、病毒结构图、生命周期图、感染流程图和考试重点标注。完整文档还应包含病毒检测技术、反病毒软件架构、防护策略、企业防护体系和应急响应等章节。", "original_text": "  \u2502  9. CertificateVer"}]